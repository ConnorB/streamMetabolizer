<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Alison Appling" />

<meta name="date" content="2016-09-20" />

<title>ODE Methods</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">ODE Methods</h1>
<h4 class="author"><em>Alison Appling</em></h4>
<h4 class="date"><em>2016-09-20</em></h4>



<div id="overview" class="section level1">
<h1>Overview</h1>
<p>This vignette demonstrates how you can choose and compare the ODE solution method, which is the numerical algorithm used to translate from a given set of daily metabolism parameters into a time series of dissolved oxygen predictions.</p>
</div>
<div id="setup" class="section level1">
<h1>Setup</h1>
<p>Load streamMetabolizer.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(streamMetabolizer)</code></pre></div>
<p>Load dplyr.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(dplyr))</code></pre></div>
<p>Get some data to work with: here weâ€™re requesting three days of data at 30-minute resolution. Thanks to Bob Hall for the test data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">data_metab</span>(<span class="st">'3'</span>,<span class="st">'30'</span>)</code></pre></div>
</div>
<div id="numerical-integration" class="section level1">
<h1>Numerical integration</h1>
<p>Inspired by Song et al. 2016, we can now do several types of numerical integration and compare them. <code>lsoda</code> often fails to converge, but <code>rk4</code> and <code>trapezoid</code> perform well and very similarly to one another (and <code>trapezoid</code> is faster). <code>trapezoid</code> is available for both MLE and Bayesian models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mm_euler &lt;-<span class="st"> </span><span class="kw">metab</span>(<span class="kw">specs</span>(<span class="kw">mm_name</span>(<span class="st">'mle'</span>, <span class="dt">ode_method=</span><span class="st">'euler'</span>)), dat)
mm_trapezoid &lt;-<span class="st"> </span><span class="kw">metab</span>(<span class="kw">specs</span>(<span class="kw">mm_name</span>(<span class="st">'mle'</span>, <span class="dt">ode_method=</span><span class="st">'trapezoid'</span>)), dat)
mm_rk4 &lt;-<span class="st"> </span><span class="kw">metab</span>(<span class="kw">specs</span>(<span class="kw">mm_name</span>(<span class="st">'mle'</span>, <span class="dt">ode_method=</span><span class="st">'rk4'</span>)), dat) 
mm_lsoda &lt;-<span class="st"> </span><span class="kw">metab</span>(<span class="kw">specs</span>(<span class="kw">mm_name</span>(<span class="st">'mle'</span>, <span class="dt">ode_method=</span><span class="st">'lsoda'</span>)), dat) </code></pre></div>
<pre><code>## Warning in metab_fun(specs = specs, data = data, data_daily = data_daily, : we've seen bad results
## with ODE methods 'lsoda', 'lsodes', and 'lsodar'. Use at your own risk</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DO.standard &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">predict_DO</span>(mm_rk4)$<span class="st">'DO.mod'</span>, <span class="dt">times=</span><span class="dv">4</span>)
ode_preds &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(
  <span class="kw">mutate</span>(<span class="kw">predict_DO</span>(mm_euler), <span class="dt">method=</span><span class="st">'euler'</span>),
  <span class="kw">mutate</span>(<span class="kw">predict_DO</span>(mm_trapezoid), <span class="dt">method=</span><span class="st">'trapezoid'</span>),
  <span class="kw">mutate</span>(<span class="kw">predict_DO</span>(mm_rk4), <span class="dt">method=</span><span class="st">'rk4'</span>),
  <span class="kw">mutate</span>(<span class="kw">predict_DO</span>(mm_lsoda), <span class="dt">method=</span><span class="st">'lsoda'</span>)) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">DO.mod.diffeuler =</span> DO.mod -<span class="st"> </span>DO.standard)
<span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(ode_preds, <span class="kw">aes</span>(<span class="dt">x=</span>solar.time)) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y=</span>DO.obs), <span class="dt">color=</span><span class="st">'grey'</span>, <span class="dt">alpha=</span><span class="fl">0.3</span>) +<span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>DO.mod, <span class="dt">color=</span>method), <span class="dt">size=</span><span class="dv">1</span>) +<span class="st"> </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(ode_preds, <span class="kw">aes</span>(<span class="dt">x=</span>solar.time)) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y=</span><span class="kw">pmax</span>(-<span class="fl">0.2</span>, <span class="kw">pmin</span>(<span class="fl">0.2</span>, DO.mod.diffeuler)), <span class="dt">color=</span>method), <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.8</span>) +<span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(-<span class="fl">0.2</span>,<span class="fl">0.2</span>)) +<span class="st"> </span><span class="kw">theme_bw</span>() +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Deviations from rk4 (capped at +/- 0.2)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
