% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_light_merged.R
\name{calc_light_merged}
\alias{calc_light_merged}
\title{Merge modeled and observed PAR into a single timeseries}
\usage{
calc_light_merged(PAR.obs = mm_data(solar.time, light), solar.time, latitude,
  longitude, max.PAR = 2326,
  coef.SW.to.PAR = formals(convert_SW_to_PAR)$coef, extrapolate = TRUE,
  attach.units = is.unitted(PAR.obs))
}
\arguments{
\item{PAR.obs}{a 2-column data.frame with columns solar.time and light, as in
argument default, containing the full time series of observed light (should
be at a lower temporal resolution than \code{PAR.mod})}

\item{solar.time}{mean solar time, as required for input to metabolism 
models. See \code{\link{mm_data}} and \code{\link{calc_solar_time}}.}

\item{latitude}{numeric value or vector indicating the site latitude in 
decimal degrees (never radians or deg-min-sec, no matter what \code{format}
is) between -90 (South Pole) and 90 (North Pole).}

\item{longitude}{numeric, in degrees, either positive and unitted ("degE" or 
"degW") or with sign indicating direction (positive = East), describing 
location of the site}

\item{max.PAR}{numeric or unitted_numeric: the PAR (umol m^-2 s^-1) that each
day should reach at peak light}

\item{coef.SW.to.PAR}{conversion coefficient; see \code{code} in 
\code{\link{convert_SW_to_PAR}}}

\item{extrapolate}{logical. Should the output include periods of time where 
only modeled light is available? Periods where only observed light is
available (i.e., those not included in solar.time) are always excluded.}

\item{attach.units}{logical. Should the returned vector be a unitted object?}

\item{PAR.mod}{a 2-column data.frame with columns solar.time and light, as in
argument default, containing the full time series of modeled light}
}
\description{
Merge two time series of photosynthetically active radiation (PAR) for a 
series of date-times.
}
\examples{
\dontrun{
library(mda.streams)
library(dplyr)
library(lubridate)
coords <- get_site_coords('nwis_08062500')
PAR.obs <- get_ts('par_calcSw', 'nwis_08062500') \%>\%
  mutate(solar.time = convert_UTC_to_solartime(DateTime, coords$lon)) \%>\%
    select(solar.time, light=par) \%>\%
    subset(solar.time >= as.POSIXct('2007-10-31', tz=tz(solar.time)) &
           solar.time < as.POSIXct('2007-11-03', tz=tz(solar.time)))
PAR.mod <- data.frame(solar.time=seq(as.POSIXct('2007-11-01', tz=tz(solar.time)),
    as.POSIXct('2007-11-04', tz=tz(solar.time)), by=as.difftime(10, units='mins'))) \%>\%
  mutate(light=calc_light(solar.time, latitude=coords$lat, longitude=coords$lon))
PAR.merged <- calc_light_merged(PAR.obs, PAR.mod$solar.time, latitude=coords$lat, longitude=coords$lon)
ggplot(bind_rows(mutate(PAR.obs, type='obs'), mutate(PAR.mod, type='mod'), mutate(PAR.merged, type='merged')), 
  aes(x=solar.time, y=light, color=type)) + geom_line() + geom_point()
}
}

