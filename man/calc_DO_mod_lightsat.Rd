% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_DO_mod_lightsat.R
\name{calc_DO_mod_lightsat}
\alias{calc_DO_mod_lightsat}
\title{Alison: the test does not work. Maybe I am wrong, but I think the error could bein:
- Line 22: in Fort Collins we wrote light=300, but shouldn't it be light=rep(300,n)??
- Lines 41 and 64: I tried light, light[i] and something similar to what you used with temperature (temperature=temp.water): par=light}
\usage{
calc_DO_mod_lightsat(PMAX.daily, ALPHA.daily, ER.daily, K600.daily, DO.sat,
  depth, temp.water, light, frac.ER, frac.D, DO.mod.1, n,
  ODE_method = "pairmeans", ...)
}
\arguments{
\item{PMAX.daily}{Maximum photosynthesis rate}

\item{ALPHA.daily}{Initial slope of the light saturation curve}

\item{ER.daily}{One ER rate per day (mg O2 / L / d), always non-positive.}

\item{K600.daily}{One K600 per day (1 / d)}

\item{DO.sat}{dissolved oxygen concentrations if the water were at 
equilibrium saturation \eqn{mg O[2] L^{-1}}{mg O2 / L}. Calculate using 
\link{calc_DO_at_sat}}

\item{depth}{stream depth, \eqn{m}{m}.}

\item{temp.water}{stream temperature in degC}

\item{light}{A vector of PAR of length n.}

\item{frac.ER}{the fraction of daily ER to apply to each timestep}

\item{frac.D}{the fraction of daily D to apply to each timestep}

\item{DO.mod.1}{the first DO.obs value, to which the first DO.mod value will 
be set}

\item{n}{number of DO.mod values to produce}

\item{ODE_method}{character specifying the numerical integration method to 
use. The default is pairmeans, where the change in DO between times t-1 and
t is a function of the mean DO.sat between times t-1 and t, mean temp.water
between times t-1 and t, mean light between times t-1 and t, etc. The Euler
method is currently more common in the literature, with each time step 
depending entirely on DO.sat, GPP, etc. at time t. Both methods are
imprecise and fast, relative to Runge-Kutta or other numerical integration
methods}

\item{...}{additional arguments passed to other variants on calc_DO_mod}
}
\description{
Calculate a time series of DO concentrations from PMAX, ALPHA, ER, K600, and other
inputs
}
\details{
\code{calc_DO_mod} simulates DO with no observation or process error.

Accepts PMAX, ALPHA, ER, etc. and returns DO.mod. Used in many functions, including 
metab_mle() and predict_DO.metab_mle()
}
\examples{
n = 24
DO <- calc_DO_mod_lightsat(PMAX.daily=0.15, ALPHA.daily=0.75, ER.daily=-9, K600.daily=2.5, 
  DO.sat=11, depth=1, temp.water=rep(12,n), light=rep(300,n),
  frac.ER=rep(1/n,n), frac.D=rep(1/n,n), 
  DO.mod.1=8, n=n, ODE_method="Euler")
\dontrun{
plot(DO)
}
}

