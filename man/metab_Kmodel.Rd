% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metab_Kmodel.R
\name{metab_Kmodel}
\alias{metab_Kmodel}
\title{Combine a time series of K estimates to predict consistent values}
\usage{
metab_Kmodel(specs = specs(mm_name("Kmodel")), data = mm_data(solar.time,
  discharge, velocity, optional = c("all")), data_daily = mm_data(date, K600,
  K600.lower, K600.upper, discharge.daily, velocity.daily, optional =
  c("K600.lower", "K600.upper", "discharge.daily", "velocity.daily")),
  info = NULL)
}
\arguments{
\item{specs}{a list of model specifications and parameters for a model. 
Although this may be specified manually (it's just a list), it is easier
and safer to use \code{\link{specs}} to generate the list, because the set
of required parameters and their defaults depends on the model given in the
\code{model_name} argument to \code{specs}. The help file for 
\code{\link{specs}} lists the necessary parameters, describes them in 
detail, and gives default values.}

\item{data}{data.frame of input data at the temporal resolution of raw 
observations (unit-value). Columns must have the same names, units, and 
format as the default. The solar.time column must also have a timezone code
('tzone' attribute) of 'UTC'. See the \strong{'Formatting \code{data}'} 
section below for a full description.}

\item{data_daily}{data.frame containing inputs with a daily timestep. See the
\strong{'Formatting \code{data_daily}'} section below for a full 
description.}

\item{info}{any information, in any format, that you would like to store 
within the metab_model object}
}
\value{
A metab_Kmodel object containing the fitted model. This object can be 
  inspected with the functions in the \code{\link{metab_model_interface}}.
}
\description{
Takes daily estimates of K, usually from nighttime regression, and regresses 
against predictors such as discharge.daily. Returns a metab_Kmodel object
that only predicts daily K, nothing else.
}
\details{
Possible approaches:

\itemize{

\item{"mean"}{Predict K as the mean of all K values}

\item{"weighted mean"}{Predict K as the mean of all K values, weighted by the
inverse of the confidence intervals in the input K values}

\item{"KvQ"}{Regress K versus Q, tending toward overall mean in ranges of Q 
with sparse data}

\item{"weighted KvQ"}{Regress K versus Q, tending toward overall mean in 
ranges of Q with sparse data, weighting high-confidence K values more 
heavily}

\item{"T smoother"}{Predict K using a loess or spline smoother over time}

\item{"Q smoother"}{Predict K using a loess or spline smoother over 
discharge.daily}

\item{"TQ smoother"}{Predict K using a loess or spline smoother over both 
time and discharge.daily}

}
}
\examples{
library(dplyr)
# create example data
set.seed(24842)
example_Ks <- data.frame(date=seq(as.Date("2012-08-15"),as.Date("2012-09-15"),
  as.difftime(1,units='days')), discharge.daily=exp(rnorm(32,2,1)), K600=rnorm(32,30,4)) \%>\%
  mutate(K600.lower=K600-5, K600.upper=K600+6)

# mean
mm <- metab_Kmodel(
  specs(mm_name('Kmodel', engine='mean')), 
  data_daily=example_Ks) # two warnings expected for engine='mean'
\dontrun{ plot_metab_preds(predict_metab(mm)) # flat b/c it's a mean }

# linear model
mm <- metab_Kmodel(
  specs(mm_name('Kmodel', engine='lm'), predictors='discharge.daily'),
  data_daily=example_Ks)
\dontrun{ plot_metab_preds(predict_metab(mm)) }

# loess
mm <- metab_Kmodel(
  specs(mm_name('Kmodel', engine='loess'), predictors='date', other_args=list(span=0.4)),
  data_daily=example_Ks)
\dontrun{ plot_metab_preds(predict_metab(mm)) }
}
\author{
Alison Appling
}
\seealso{
Other metab_model: \code{\link{metab_bayes}},
  \code{\link{metab_mle}}, \code{\link{metab_night}},
  \code{\link{metab_sim}}
}

