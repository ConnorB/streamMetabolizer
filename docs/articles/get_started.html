<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quickstart • streamMetabolizer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quickstart">
<meta property="og:description" content="streamMetabolizer">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">streamMetabolizer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.12.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_prep.html">Data Preparation</a>
    </li>
    <li>
      <a href="../articles/get_started.html">Quickstart</a>
    </li>
    <li>
      <a href="../articles/gpp_er_eqs.html">GPP and ER Equations</a>
    </li>
    <li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/model_structures.html">Model Structures</a>
    </li>
    <li>
      <a href="../articles/models_bayes.html">Bayesian Models</a>
    </li>
    <li>
      <a href="../articles/models_mle.html">MLE Models</a>
    </li>
    <li>
      <a href="../articles/ode_methods.html">ODE Methods</a>
    </li>
    <li>
      <a href="../articles/simulations.html">Simulations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/USGS-R/streamMetabolizer/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="get_started_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Quickstart</h1>
                        <h4 class="author">Alison Appling</h4>
            
            <h4 class="date">2021-07-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/USGS-R/streamMetabolizer/blob/master/vignettes/get_started.Rmd"><code>vignettes/get_started.Rmd</code></a></small>
      <div class="hidden name"><code>get_started.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This tutorial shows how to estimate stream metabolism using <code>streamMetabolizer</code> and some example data supplied by Bob Hall for French Creek in Laramie, WY.</p>
<p>There are four steps to fitting a metabolism model in <code>streamMetabolizer</code>.</p>
<ol style="list-style-type: decimal">
<li>Prepare and inspect the input data.</li>
<li>Choose a model configuration appropriate to your data.</li>
<li>Fit the model.</li>
<li>Inspect the output.</li>
</ol>
<p>In this tutorial we will demonstrate these steps for a single model structure and a single set of specifications, but you should also consider other structures and should always tailor the specifications to your dataset and site knowledge. For more details, see:</p>
<ul>
<li><a href="models_bayes.html">Bayesian Models</a></li>
<li><a href="models_mle.html">MLE Models</a></li>
<li><a href="models_other.html">Model Types</a></li>
</ul>
</div>
<div id="preliminaries" class="section level1">
<h1 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h1>
<p>If you haven’t already installed the package, see the <a href="installation.html">Installation</a> tutorial.</p>
<p>Next load the R libraries. Only <code>streamMetabolizer</code> is required to run models, but we’ll also be using <code>dplyr</code> to inspect the results.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/USGS-R/streamMetabolizer">streamMetabolizer</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="preparing-the-input-data" class="section level1">
<h1 class="hasAnchor">
<a href="#preparing-the-input-data" class="anchor"></a>1. Preparing the input data</h1>
<p>Load a small example dataset from the package (data are from French Creek in Laramie, WY, courtesy of Bob Hall). Explicitly attached units are optional but useful for confirming that the data are in the expected format. We’ll use the <code>streamMetabolizer</code> standard in defining our day to run from 4 am (<code>day_start=4</code>) to 4 am (<code>day_end=28</code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_metab.html">data_metab</a></span><span class="op">(</span>num_days<span class="op">=</span><span class="st">'3'</span>, res<span class="op">=</span><span class="st">'15'</span>, day_start<span class="op">=</span><span class="fl">4</span>, day_end<span class="op">=</span><span class="fl">28</span>, attach.units<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: The `attach.units` argument of `data_metab()` is deprecated as of streamMetabolizer 0.12.0.
## In the future, streamMetabolizer will stop using the unitted package entirely.</code></pre>
<pre><code>## Warning: The `attach.units` argument of `load_french_creek()` is deprecated as of streamMetabolizer 0.12.0.
## In the future, streamMetabolizer will stop using the unitted package entirely.</code></pre>
<p>See the <a href="data_prep.html">Data Preparation</a> tutorial for more on how to properly format and inspect a dataset.</p>
</div>
<div id="configuring-the-model" class="section level1">
<h1 class="hasAnchor">
<a href="#configuring-the-model" class="anchor"></a>2. Configuring the model</h1>
<p>There are two steps to configuring a metabolism model in <code>streamMetabolizer</code>.</p>
<ol style="list-style-type: lower-alpha">
<li>Identify the name of the model structure you want using <code><a href="../reference/mm_name.html">mm_name()</a></code>.</li>
<li>Set the specifications for the model using defaults from<code><a href="../reference/specs.html">specs()</a></code> as a starting point.</li>
</ol>
<div id="a--choose-a-model-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#a--choose-a-model-structure" class="anchor"></a>2a. Choose a model structure</h2>
<p>For this example, we will specify a Bayesian model with both observation error and process error. We won’t pool K600 here because we don’t have many days of data, but pooling is one feature that makes Bayesian models better than MLE models in general. Another great feature of Bayesian models is that they produce more accurate and nuanced confidence intervals.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bayes_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mm_name.html">mm_name</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">'bayes'</span>, pool_K600<span class="op">=</span><span class="st">'none'</span>, err_obs_iid<span class="op">=</span><span class="cn">TRUE</span>, err_proc_iid<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">bayes_name</span></code></pre></div>
<pre><code>## [1] "b_np_oipi_tr_plrckm.stan"</code></pre>
</div>
<div id="b--set-the-specifications" class="section level2">
<h2 class="hasAnchor">
<a href="#b--set-the-specifications" class="anchor"></a>2b. Set the specifications</h2>
<p>We now pass the model name to <code><a href="../reference/specs.html">specs()</a></code> to get a list of default specifications for this model.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bayes_specs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/specs.html">specs</a></span><span class="op">(</span><span class="va">bayes_name</span><span class="op">)</span>
<span class="va">bayes_specs</span></code></pre></div>
<pre><code>## Model specifications:
##   model_name               b_np_oipi_tr_plrckm.stan                             
##   engine                   stan                                                 
##   split_dates              FALSE                                                
##   keep_mcmcs               TRUE                                                 
##   keep_mcmc_data           TRUE                                                 
##   day_start                4                                                    
##   day_end                  28                                                   
##   day_tests                full_day, even_timesteps, complete_data, pos_disch...
##   required_timestep        NA                                                   
##   GPP_daily_mu             3.1                                                  
##   GPP_daily_lower          -Inf                                                 
##   GPP_daily_sigma          6                                                    
##   ER_daily_mu              -7.1                                                 
##   ER_daily_upper           Inf                                                  
##   ER_daily_sigma           7.1                                                  
##   K600_daily_meanlog       2.484906649788                                       
##   K600_daily_sdlog         1                                                    
##   err_obs_iid_sigma_scale  0.03                                                 
##   err_proc_iid_sigma_scale 5                                                    
##   params_in                GPP_daily_mu, GPP_daily_lower, GPP_daily_sigma, ER...
##   params_out               GPP, ER, DO_R2, GPP_daily, ER_daily, K600_daily, e...
##   n_chains                 4                                                    
##   n_cores                  4                                                    
##   burnin_steps             500                                                  
##   saved_steps              500                                                  
##   thin_steps               1                                                    
##   verbose                  FALSE</code></pre>
<p>At this point we can alter some of the specifications if desired.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># one way to alter specifications: call specs() again</span>
<span class="va">bayes_specs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/specs.html">specs</a></span><span class="op">(</span><span class="va">bayes_name</span>, burnin_steps<span class="op">=</span><span class="fl">100</span>, saved_steps<span class="op">=</span><span class="fl">200</span>, n_cores<span class="op">=</span><span class="fl">1</span>, GPP_daily_mu<span class="op">=</span><span class="fl">3</span>, GPP_daily_sigma<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="co"># another way: use revise()</span>
<span class="va">bayes_specs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/revise.html">revise</a></span><span class="op">(</span><span class="va">bayes_specs</span>, burnin_steps<span class="op">=</span><span class="fl">100</span>, saved_steps<span class="op">=</span><span class="fl">200</span>, n_cores<span class="op">=</span><span class="fl">1</span>, GPP_daily_mu<span class="op">=</span><span class="fl">3</span>, GPP_daily_sigma<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>Here I’ve used a very small number of <code>burnin_steps</code> and <code>saved_steps</code> because I don’t want to wait long for the vignette to run. When you run your own models, you should bump those numbers up substantially (to several thousand or so, depending on exactly which model you’re using.)</p>
<p>Other Bayesian model specifications will also need your close attention when you’re running your own models. See <a href="models_bayes.html">Bayesian Models</a> for details.</p>
</div>
</div>
<div id="fitting-the-model" class="section level1">
<h1 class="hasAnchor">
<a href="#fitting-the-model" class="anchor"></a>3. Fitting the model</h1>
<p>Once a model has been configured, you can fit the model to data with <code><a href="../reference/metab.html">metab()</a></code>. Bayesian models take a while to run, so be patient. Or switch to an MLE model if you can afford to sacrifice some accuracy for speed. (This small example usually takes about 30 seconds on my computer.)</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metab.html">metab</a></span><span class="op">(</span><span class="va">bayes_specs</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></code></pre></div>
<pre><code>## Trying to compile a simple C file</code></pre>
</div>
<div id="inspecting-the-model" class="section level1">
<h1 class="hasAnchor">
<a href="#inspecting-the-model" class="anchor"></a>4. Inspecting the model</h1>
<p>Once you’ve fit a model, you can inspect the output with functions including <code><a href="../reference/predict_metab.html">predict_metab()</a></code> and <code><a href="../reference/plot_metab_preds.html">plot_metab_preds()</a></code>, <code><a href="../reference/predict_DO.html">predict_DO()</a></code> and <code><a href="../reference/plot_DO_preds.html">plot_DO_preds()</a></code>, <code><a href="../reference/get_params.html">get_params()</a></code>, and <code><a href="../reference/get_fit.html">get_fit()</a></code>.</p>
<p>Start by simply printing the model to the console.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mm</span></code></pre></div>
<pre><code>## metab_model of type metab_bayes 
## streamMetabolizer version 0.12.0 
## Specifications:
##   model_name               b_np_oipi_tr_plrckm.stan                             
##   engine                   stan                                                 
##   split_dates              FALSE                                                
##   keep_mcmcs               TRUE                                                 
##   keep_mcmc_data           TRUE                                                 
##   day_start                4                                                    
##   day_end                  28                                                   
##   day_tests                full_day, even_timesteps, complete_data, pos_disch...
##   required_timestep        NA                                                   
##   GPP_daily_mu             3                                                    
##   GPP_daily_lower          -Inf                                                 
##   GPP_daily_sigma          2                                                    
##   ER_daily_mu              -7.1                                                 
##   ER_daily_upper           Inf                                                  
##   ER_daily_sigma           7.1                                                  
##   K600_daily_meanlog       2.484906649788                                       
##   K600_daily_sdlog         1                                                    
##   err_obs_iid_sigma_scale  0.03                                                 
##   err_proc_iid_sigma_scale 5                                                    
##   params_in                GPP_daily_mu, GPP_daily_lower, GPP_daily_sigma, ER...
##   params_out               GPP, ER, DO_R2, GPP_daily, ER_daily, K600_daily, e...
##   n_chains                 4                                                    
##   n_cores                  1                                                    
##   burnin_steps             100                                                  
##   saved_steps              200                                                  
##   thin_steps               1                                                    
##   verbose                  FALSE                                                
##   model_path               /private/var/folders/_0/fbg0ffkj6z3fb_7jvm8wg86r00...
## Fitting time: 16.679 secs elapsed
## Parameters (3 dates):
##         date GPP.daily GPP.daily.lower GPP.daily.upper   ER.daily
## 1 2012-09-18 4.607255         3.583838        8.190710 -3.571321 
## 2 2012-09-19 4.300345         3.303195        8.350941 -3.405118 
## 3 2012-09-20 5.171397         2.262458        7.216639 -3.678998 
##   ER.daily.lower ER.daily.upper K600.daily K600.daily.lower K600.daily.upper
## 1      -6.406937      -2.811030  47.42048          38.01067         83.38832
## 2      -6.873145      -2.568283  41.51215          32.52184         79.80997
## 3      -5.343638      -1.451997  51.98903          25.13151         73.32482
##   msgs.fit
## 1  w      
## 2  w      
## 3  w      
## Fitting warnings:
##   There were 4 chains where the estimated Bayesian Fraction of Missing Information was low. See
## http://mc-stan.org/misc/warnings.html#bfmi-low
##   Examine the pairs() plot to diagnose sampling problems
##   The largest R-hat is 3.47, indicating chains have not mixed.
## Running the chains for more iterations may help. See
## http://mc-stan.org/misc/warnings.html#r-hat
##   Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.
## Running the chains for more iterations may help. See
## http://mc-stan.org/misc/warnings.html#bulk-ess
##   Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.
## Running the chains for more iterations may help. See
## http://mc-stan.org/misc/warnings.html#tail-ess
##   3 dates: overall warnings
## Predictions (3 dates):
## # A tibble: 3 x 9
##   date         GPP GPP.lower GPP.upper    ER ER.lower ER.upper msgs.fit 
##   &lt;date&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    
## 1 2012-09-18  4.61      3.58      8.19 -3.57    -6.41    -2.81 "w      "
## 2 2012-09-19  4.30      3.30      8.35 -3.41    -6.87    -2.57 "w      "
## 3 2012-09-20  5.17      2.26      7.22 -3.68    -5.34    -1.45 "w      "
## # … with 1 more variable: msgs.pred &lt;chr&gt;</code></pre>
<p>Here are the daily metabolism predictions from the model:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/predict_metab.html">predict_metab</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 10
##   date         GPP GPP.lower GPP.upper    ER ER.lower ER.upper msgs.fit warnings
##   &lt;date&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
## 1 2012-09-18  4.61      3.58      8.19 -3.57    -6.41    -2.81 "w     … ""      
## 2 2012-09-19  4.30      3.30      8.35 -3.41    -6.87    -2.57 "w     … ""      
## 3 2012-09-20  5.17      2.26      7.22 -3.68    -5.34    -1.45 "w     … ""      
## # … with 1 more variable: errors &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_metab_preds.html">plot_metab_preds</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span></code></pre></div>
<p><img src="get_started_files/figure-html/bayes_pred_fig-1.png" width="480"></p>
<p>You can inspect more of the fitted daily parameters, including K600, with <code><a href="../reference/get_params.html">get_params()</a></code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_params.html">get_params</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 9
##   date       GPP.daily GPP.daily.sd ER.daily ER.daily.sd K600.daily
##   &lt;date&gt;         &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;
## 1 2012-09-18      5.13         1.35    -4.09        1.13       52.8
## 2 2012-09-19      4.97         1.79    -3.98        1.54       47.9
## 3 2012-09-20      4.77         1.46    -3.42        1.09       49.2
## # … with 3 more variables: K600.daily.sd &lt;dbl&gt;, warnings &lt;chr&gt;, errors &lt;chr&gt;</code></pre>
<p>Here are the first few dissolved oxygen predictions from the model (<code>DO.mod</code>). They are returned along with the input data for convenience.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/predict_DO.html">predict_DO</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>    date          solar.time DO.obs   DO.sat depth temp.water light</code></pre>
<p>1 2012-09-18 2012-09-18 04:05:58 8.41 9.083329 0.16 3.60 0 2 2012-09-18 2012-09-18 04:20:58 8.42 9.093063 0.16 3.56 0 3 2012-09-18 2012-09-18 04:35:58 8.42 9.105254 0.16 3.51 0 4 2012-09-18 2012-09-18 04:50:58 8.43 9.112582 0.16 3.48 0 5 2012-09-18 2012-09-18 05:05:58 8.45 9.127267 0.16 3.42 0 6 2012-09-18 2012-09-18 05:20:58 8.46 9.137079 0.16 3.38 0 DO.mod 1 8.410000 2 8.400303 3 8.396858 4 8.397333 5 8.400844 6 8.406791</p>
<p>And here are the dissolved oxygen predictions in a figure:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_DO_preds.html">plot_DO_preds</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span></code></pre></div>
<p><img src="get_started_files/figure-html/bayes_pdo_fig-1.png" width="480"></p>
<p>For Bayesian models only, you can dig even deeper using <code>get_mcmc</code>, which returns a <code>stanfit</code> object that can be inspected using the <code>rstan</code> package. (These traceplots are pretty bad because we used so few MCMC iterations. You should strive for better in your final models.)</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mcmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mcmc.html">get_mcmc</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span>
<span class="fu">rstan</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stanfit-method-traceplot.html">traceplot</a></span><span class="op">(</span><span class="va">mcmc</span>, pars<span class="op">=</span><span class="st">'K600_daily'</span>, nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="get_started_files/figure-html/unnamed-chunk-3-1.png" width="480"></p>
<p>The <code><a href="../reference/get_fit.html">get_fit()</a></code> function returns a list of data.frames, one per temporal resolution, containing all fitted values and details about their distributions and convergence. Here are just the overall metrics of model convergence (<code>Rhat</code>s, or potential scale reduction statistics; see Gelman and Rubin 1992 or Brooks and Gelman 1998):</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_fit.html">get_fit</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span><span class="op">$</span><span class="va">overall</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">ends_with</a></span><span class="op">(</span><span class="st">'Rhat'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   err_obs_iid_sigma_Rhat err_proc_iid_sigma_Rhat lp___Rhat
##                    &lt;dbl&gt;                   &lt;dbl&gt;     &lt;dbl&gt;
## 1                   1.93                    3.39      2.97</code></pre>
<p>And here is a list of all column names available through <code><a href="../reference/get_fit.html">get_fit()</a></code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_fit.html">get_fit</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span></code></pre></div>
<pre><code>## $daily
##  [1] "date"               "GPP_mean"           "GPP_se_mean"       
##  [4] "GPP_sd"             "GPP_2.5pct"         "GPP_25pct"         
##  [7] "GPP_50pct"          "GPP_75pct"          "GPP_97.5pct"       
## [10] "GPP_n_eff"          "GPP_Rhat"           "ER_mean"           
## [13] "ER_se_mean"         "ER_sd"              "ER_2.5pct"         
## [16] "ER_25pct"           "ER_50pct"           "ER_75pct"          
## [19] "ER_97.5pct"         "ER_n_eff"           "ER_Rhat"           
## [22] "DO_R2_mean"         "DO_R2_se_mean"      "DO_R2_sd"          
## [25] "DO_R2_2.5pct"       "DO_R2_25pct"        "DO_R2_50pct"       
## [28] "DO_R2_75pct"        "DO_R2_97.5pct"      "DO_R2_n_eff"       
## [31] "DO_R2_Rhat"         "GPP_daily_mean"     "GPP_daily_se_mean" 
## [34] "GPP_daily_sd"       "GPP_daily_2.5pct"   "GPP_daily_25pct"   
## [37] "GPP_daily_50pct"    "GPP_daily_75pct"    "GPP_daily_97.5pct" 
## [40] "GPP_daily_n_eff"    "GPP_daily_Rhat"     "ER_daily_mean"     
## [43] "ER_daily_se_mean"   "ER_daily_sd"        "ER_daily_2.5pct"   
## [46] "ER_daily_25pct"     "ER_daily_50pct"     "ER_daily_75pct"    
## [49] "ER_daily_97.5pct"   "ER_daily_n_eff"     "ER_daily_Rhat"     
## [52] "K600_daily_mean"    "K600_daily_se_mean" "K600_daily_sd"     
## [55] "K600_daily_2.5pct"  "K600_daily_25pct"   "K600_daily_50pct"  
## [58] "K600_daily_75pct"   "K600_daily_97.5pct" "K600_daily_n_eff"  
## [61] "K600_daily_Rhat"    "valid_day"          "warnings"          
## [64] "errors"            
## 
## $inst
##  [1] "date"                 "solar.time"           "err_obs_iid_mean"    
##  [4] "err_obs_iid_se_mean"  "err_obs_iid_sd"       "err_obs_iid_2.5pct"  
##  [7] "err_obs_iid_25pct"    "err_obs_iid_50pct"    "err_obs_iid_75pct"   
## [10] "err_obs_iid_97.5pct"  "err_obs_iid_n_eff"    "err_obs_iid_Rhat"    
## [13] "err_proc_iid_mean"    "err_proc_iid_se_mean" "err_proc_iid_sd"     
## [16] "err_proc_iid_2.5pct"  "err_proc_iid_25pct"   "err_proc_iid_50pct"  
## [19] "err_proc_iid_75pct"   "err_proc_iid_97.5pct" "err_proc_iid_n_eff"  
## [22] "err_proc_iid_Rhat"   
## 
## $overall
##  [1] "date_index"                 "time_index"                
##  [3] "index"                      "err_obs_iid_sigma_mean"    
##  [5] "err_obs_iid_sigma_se_mean"  "err_obs_iid_sigma_sd"      
##  [7] "err_obs_iid_sigma_2.5pct"   "err_obs_iid_sigma_25pct"   
##  [9] "err_obs_iid_sigma_50pct"    "err_obs_iid_sigma_75pct"   
## [11] "err_obs_iid_sigma_97.5pct"  "err_obs_iid_sigma_n_eff"   
## [13] "err_obs_iid_sigma_Rhat"     "err_proc_iid_sigma_mean"   
## [15] "err_proc_iid_sigma_se_mean" "err_proc_iid_sigma_sd"     
## [17] "err_proc_iid_sigma_2.5pct"  "err_proc_iid_sigma_25pct"  
## [19] "err_proc_iid_sigma_50pct"   "err_proc_iid_sigma_75pct"  
## [21] "err_proc_iid_sigma_97.5pct" "err_proc_iid_sigma_n_eff"  
## [23] "err_proc_iid_sigma_Rhat"    "lp___mean"                 
## [25] "lp___se_mean"               "lp___sd"                   
## [27] "lp___2.5pct"                "lp___25pct"                
## [29] "lp___50pct"                 "lp___75pct"                
## [31] "lp___97.5pct"               "lp___n_eff"                
## [33] "lp___Rhat"                 
## 
## $warnings
## NULL
## 
## $errors
## NULL</code></pre>
<p>You’re on your way!</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alison P. Appling, Robert O. Hall, Maite Arroita, Charles B. Yackulic.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
