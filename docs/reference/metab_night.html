<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Nighttime regression for K estimation — metab_night • streamMetabolizer</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Nighttime regression for K estimation — metab_night" />
<meta property="og:description" content="Fits a model to estimate K from nighttime input data on DO, temperature, 
light, etc. The default day start &amp;amp; end are 12 noon on the preceding to 
present day; the algorithm then filters the data to just those time points 
for which light is very low. Discharge is only used, if at all, to identify
and exclude days with any negative discharge." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">streamMetabolizer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/data_prep.html">Data Preparation</a>
    </li>
    <li>
      <a href="../articles/get_started.html">Quickstart</a>
    </li>
    <li>
      <a href="../articles/gpp_er_eqs.html">GPP and ER Equations</a>
    </li>
    <li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/model_structures.html">Model Structures</a>
    </li>
    <li>
      <a href="../articles/models_bayes.html">Bayesian Models</a>
    </li>
    <li>
      <a href="../articles/models_mle.html">MLE Models</a>
    </li>
    <li>
      <a href="../articles/ode_methods.html">ODE Methods</a>
    </li>
    <li>
      <a href="../articles/simulations.html">Simulations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/USGS-R/streamMetabolizer/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Nighttime regression for K estimation</h1>
    <small class="dont-index">Source: <a href='https://github.com/USGS-R/streamMetabolizer/blob/master/R/metab_night.R'><code>R/metab_night.R</code></a></small>
    <div class="hidden name"><code>metab_night.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits a model to estimate K from nighttime input data on DO, temperature, 
light, etc. The default day start &amp; end are 12 noon on the preceding to 
present day; the algorithm then filters the data to just those time points 
for which light is very low. Discharge is only used, if at all, to identify
and exclude days with any negative discharge.</p>
    </div>

    <pre class="usage"><span class='fu'>metab_night</span>(
  <span class='kw'>specs</span> <span class='kw'>=</span> <span class='fu'><a href='specs.html'>specs</a></span>(<span class='fu'><a href='mm_name.html'>mm_name</a></span>(<span class='st'>"night"</span>)),
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'><a href='mm_data.html'>mm_data</a></span>(<span class='no'>solar.time</span>, <span class='no'>DO.obs</span>, <span class='no'>DO.sat</span>, <span class='no'>depth</span>, <span class='no'>temp.water</span>, <span class='no'>light</span>, <span class='no'>discharge</span>,
    <span class='kw'>optional</span> <span class='kw'>=</span> <span class='st'>"discharge"</span>),
  <span class='kw'>data_daily</span> <span class='kw'>=</span> <span class='fu'><a href='mm_data.html'>mm_data</a></span>(<span class='kw'>NULL</span>),
  <span class='kw'>info</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>specs</th>
      <td><p>a list of model specifications and parameters for a model. 
Although this may be specified manually (it's just a list), it is easier
and safer to use <code><a href='specs.html'>specs</a></code> to generate the list, because the set
of required parameters and their defaults depends on the model given in the
<code>model_name</code> argument to <code>specs</code>. The help file for 
<code><a href='specs.html'>specs</a></code> lists the necessary parameters, describes them in 
detail, and gives default values.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data.frame (not a tbl_df) of input data at the temporal
resolution of raw observations (unit-value). Columns must have the same
names, units, and format as the default. The solar.time column must also
have a timezone code ('tzone' attribute) of 'UTC'. See the
<strong>'Formatting <code>data</code>'</strong> section below for a full description.</p></td>
    </tr>
    <tr>
      <th>data_daily</th>
      <td><p>data.frame containing inputs with a daily timestep. See the
<strong>'Formatting <code>data_daily</code>'</strong> section below for a full 
description.</p></td>
    </tr>
    <tr>
      <th>info</th>
      <td><p>any information, in any format, that you would like to store 
within the metab_model object</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A metab_night object containing the fitted model. This object can be 
  inspected with the functions in the <code><a href='metab_model_interface.html'>metab_model_interface</a></code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other metab_model: 
<code><a href='metab_Kmodel.html'>metab_Kmodel</a></code>,
<code><a href='metab_bayes.html'>metab_bayes</a></code>,
<code><a href='metab_mle.html'>metab_mle</a></code>,
<code><a href='metab_sim.html'>metab_sim</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='data_metab.html'>data_metab</a></span>(<span class='st'>'3'</span>, <span class='kw'>day_start</span><span class='kw'>=</span><span class='fl'>12</span>, <span class='kw'>day_end</span><span class='kw'>=</span><span class='fl'>35</span>)
<span class='no'>mm</span> <span class='kw'>&lt;-</span> <span class='fu'>metab_night</span>(<span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span>)
<span class='fu'><a href='predict_metab.html'>predict_metab</a></span>(<span class='no'>mm</span>)</div><div class='output co'>#&gt;         date GPP GPP.lower GPP.upper        ER  ER.lower  ER.upper msgs.fit
#&gt; 1 2012-09-18   0        NA        NA -2.122498 -2.351240 -1.893755         
#&gt; 2 2012-09-19   0        NA        NA -2.927715 -3.233801 -2.621628         
#&gt; 3 2012-09-20   0        NA        NA -2.125522 -2.305859 -1.945185         
#&gt;   warnings errors
#&gt; 1                
#&gt; 2                
#&gt; 3                </div><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='plot_DO_preds.html'>plot_DO_preds</a></span>(<span class='fu'><a href='predict_DO.html'>predict_DO</a></span>(<span class='no'>mm</span>))
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alison P. Appling, Robert O. Hall, Maite Arroita, Charles B. Yackulic.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


