<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Merge modeled and observed PAR into a single timeseries — calc_light_merged • streamMetabolizer</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Merge modeled and observed PAR into a single timeseries — calc_light_merged" />
<meta property="og:description" content="Merge two time series (one observed, one modeled) of photosynthetically 
active radiation (PAR) for a series of date-times. You can also think about 
this as a way to smoothly interpolate a time series of observations." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">streamMetabolizer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/data_prep.html">Data Preparation</a>
    </li>
    <li>
      <a href="../articles/get_started.html">Quickstart</a>
    </li>
    <li>
      <a href="../articles/gpp_er_eqs.html">GPP and ER Equations</a>
    </li>
    <li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/model_structures.html">Model Structures</a>
    </li>
    <li>
      <a href="../articles/models_bayes.html">Bayesian Models</a>
    </li>
    <li>
      <a href="../articles/models_mle.html">MLE Models</a>
    </li>
    <li>
      <a href="../articles/ode_methods.html">ODE Methods</a>
    </li>
    <li>
      <a href="../articles/simulations.html">Simulations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/USGS-R/streamMetabolizer/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Merge modeled and observed PAR into a single timeseries</h1>
    <small class="dont-index">Source: <a href='https://github.com/USGS-R/streamMetabolizer/blob/master/R/calc_light_merged.R'><code>R/calc_light_merged.R</code></a></small>
    <div class="hidden name"><code>calc_light_merged.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Merge two time series (one observed, one modeled) of photosynthetically 
active radiation (PAR) for a series of date-times. You can also think about 
this as a way to smoothly interpolate a time series of observations.</p>
    </div>

    <pre class="usage"><span class='fu'>calc_light_merged</span>(
  <span class='kw'>PAR.obs</span> <span class='kw'>=</span> <span class='fu'><a href='mm_data.html'>mm_data</a></span>(<span class='no'>solar.time</span>, <span class='no'>light</span>),
  <span class='no'>solar.time</span>,
  <span class='no'>latitude</span>,
  <span class='no'>longitude</span>,
  <span class='kw'>max.PAR</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>max.gap</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/difftime.html'>as.difftime</a></span>(<span class='fl'>3</span>, <span class='kw'>units</span> <span class='kw'>=</span> <span class='st'>"hours"</span>),
  <span class='kw'>attach.units</span> <span class='kw'>=</span> <span class='fu'>is.unitted</span>(<span class='no'>PAR.obs</span>)
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>PAR.obs</th>
      <td><p>a 2-column data.frame with columns solar.time and light, as in
argument default, containing the full time series of observed light (should
be at a lower temporal resolution than <code>PAR.mod</code>)</p></td>
    </tr>
    <tr>
      <th>solar.time</th>
      <td><p>a vector of mean solar times for which the light should be 
modeled and merged with the values in PAR.obs</p></td>
    </tr>
    <tr>
      <th>latitude</th>
      <td><p>numeric value or vector indicating the site latitude in 
decimal degrees (never radians or deg-min-sec, no matter what <code>format</code>
is) between -90 (South Pole) and 90 (North Pole).</p></td>
    </tr>
    <tr>
      <th>longitude</th>
      <td><p>numeric, in degrees, either positive and unitted ("degE" or 
"degW") or with sign indicating direction (positive = East), describing 
location of the site</p></td>
    </tr>
    <tr>
      <th>max.PAR</th>
      <td><p>the maximum PAR, as in calc_light. if NA, this function does
its best to guess a max.PAR that will make modeled light pretty similar to
cloud-free days of observed light</p></td>
    </tr>
    <tr>
      <th>max.gap</th>
      <td><p>difftime or NA. If difftime, the maximum gap between a light 
observation and a time point in solar.time, beyond which no value will be 
given for light at that solar.time. If NA, all values will be modeled, even
if they are many days away from a light observation.</p></td>
    </tr>
    <tr>
      <th>attach.units</th>
      <td><p>logical. Should the returned vector be a unitted object?</p></td>
    </tr>
    </table>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dplyr</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>ggplot2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>unitted</span>)
<span class='no'>timebounds</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>'2008-03-12 00:00'</span>, <span class='st'>'2008-03-12 23:59'</span>), <span class='kw'>tz</span><span class='kw'>=</span><span class='st'>'UTC'</span>)
<span class='no'>coords</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>lat</span><span class='kw'>=</span><span class='fl'>32.4</span>, <span class='kw'>lon</span><span class='kw'>=</span>-<span class='fl'>96.5</span>)
<span class='no'>PAR.obs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/reexports.html'>data_frame</a></span>(
  <span class='kw'>solar.time</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='no'>timebounds</span>[<span class='fl'>1</span>], <span class='no'>timebounds</span>[<span class='fl'>2</span>], <span class='kw'>by</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/difftime.html'>as.difftime</a></span>(<span class='fl'>3</span>, <span class='kw'>units</span><span class='kw'>=</span><span class='st'>'hours'</span>)),
  <span class='kw'>light</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>85.9</span>, <span class='fl'>1160.5</span>, <span class='fl'>1539.0</span>, <span class='fl'>933.9</span>, <span class='fl'>0</span>, <span class='fl'>0</span>)
) <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span>()
<span class='no'>PAR.mod</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/reexports.html'>data_frame</a></span>(
  <span class='kw'>solar.time</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='no'>timebounds</span>[<span class='fl'>1</span>], <span class='no'>timebounds</span>[<span class='fl'>2</span>], <span class='kw'>by</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/difftime.html'>as.difftime</a></span>(<span class='fl'>0.25</span>, <span class='kw'>units</span><span class='kw'>=</span><span class='st'>'hours'</span>)),
  <span class='kw'>light</span><span class='kw'>=</span><span class='fu'><a href='calc_light.html'>calc_light</a></span>(<span class='no'>solar.time</span>, <span class='kw'>latitude</span><span class='kw'>=</span><span class='no'>coords</span>$<span class='no'>lat</span>, <span class='kw'>longitude</span><span class='kw'>=</span><span class='no'>coords</span>$<span class='no'>lon</span>)
) <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span>()
<span class='no'>PAR.merged</span> <span class='kw'>&lt;-</span> <span class='fu'>calc_light_merged</span>(<span class='no'>PAR.obs</span>, <span class='no'>PAR.mod</span>$<span class='no'>solar.time</span>,
  <span class='kw'>latitude</span><span class='kw'>=</span><span class='no'>coords</span>$<span class='no'>lat</span>, <span class='kw'>longitude</span><span class='kw'>=</span><span class='no'>coords</span>$<span class='no'>lon</span>, <span class='kw'>max.gap</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/difftime.html'>as.difftime</a></span>(<span class='fl'>20</span>, <span class='kw'>units</span><span class='kw'>=</span><span class='st'>'hours'</span>))
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span>(<span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/unitted/man/deunitted.html'>v</a></span>(<span class='no'>PAR.obs</span>), <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'obs'</span>), <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/unitted/man/deunitted.html'>v</a></span>(<span class='no'>PAR.mod</span>), <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'mod'</span>),
                 <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/unitted/man/deunitted.html'>v</a></span>(<span class='no'>PAR.merged</span>), <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'merged'</span>)) <span class='kw'>%&gt;%</span>
       <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='kw'>type</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>ordered</a></span>(<span class='no'>type</span>, <span class='kw'>levels</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>'obs'</span>,<span class='st'>'mod'</span>,<span class='st'>'merged'</span>))),
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='no'>solar.time</span>, <span class='kw'>y</span><span class='kw'>=</span><span class='no'>light</span>, <span class='kw'>color</span><span class='kw'>=</span><span class='no'>type</span>)) + <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span>() + <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span>() + <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span>()
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alison P. Appling, Robert O. Hall, Maite Arroita, Charles B. Yackulic.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


